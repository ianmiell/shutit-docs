%
% API Documentation for ShutIt
% Module shutit_main
%
% Generated by epydoc 3.0.1
% [Tue Feb 17 12:53:50 2015]
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                          Module Description                           %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    \index{shutit\_main \textit{(module)}|(}
\section{Module shutit\_main}

    \label{shutit_main}
ShutIt is a means of building stateless target hosts in a flexible and 
predictable way.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               Functions                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \subsection{Functions}

    \label{shutit_main:module_ids}
    \index{shutit\_main \textit{(module)}!shutit\_main.module\_ids \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{module\_ids}(\textit{shutit}, \textit{rev}={\tt False})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Gets a list of module ids guaranteed to be sorted by run\_order, 
    ignoring conn modules (run order {\textless} 0).

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:allowed_module_ids}
    \index{shutit\_main \textit{(module)}!shutit\_main.allowed\_module\_ids \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{allowed\_module\_ids}(\textit{shutit}, \textit{rev}={\tt False})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Gets a list of module ids that are allowed to be run, guaranteed to be 
    sorted by run\_order, ignoring conn modules (run order {\textless} 0).

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:disallowed_module_ids}
    \index{shutit\_main \textit{(module)}!shutit\_main.disallowed\_module\_ids \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{disallowed\_module\_ids}(\textit{shutit}, \textit{rev}={\tt False})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Gets a list of disallowed module ids that are not allowed to be run, 
    guaranteed to be sorted by run\_order, ignoring conn modules (run order
    {\textless} 0).

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:print_modules}
    \index{shutit\_main \textit{(module)}!shutit\_main.print\_modules \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{print\_modules}(\textit{shutit})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Returns a string table representing the modules in the ShutIt module 
    map.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:stop_all}
    \index{shutit\_main \textit{(module)}!shutit\_main.stop\_all \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{stop\_all}(\textit{shutit}, \textit{run\_order}={\tt -1})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Runs stop method on all modules less than the passed-in run\_order. 
    Used when target is exporting itself mid-build, so we clean up state 
    before committing run files etc.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:start_all}
    \index{shutit\_main \textit{(module)}!shutit\_main.start\_all \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{start\_all}(\textit{shutit}, \textit{run\_order}={\tt -1})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Runs start method on all modules less than the passed-in run\_order. 
    Used when target is exporting itself mid-build, so we can export a 
    clean target and still depended-on modules running if necessary.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:is_installed}
    \index{shutit\_main \textit{(module)}!shutit\_main.is\_installed \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{is\_installed}(\textit{shutit}, \textit{shutit\_module\_obj})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Returns true if this module is installed. Uses cache where possible.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:is_to_be_built_or_is_installed}
    \index{shutit\_main \textit{(module)}!shutit\_main.is\_to\_be\_built\_or\_is\_installed \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{is\_to\_be\_built\_or\_is\_installed}(\textit{shutit}, \textit{shutit\_module\_obj})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Returns true if this module is configured to be built, or if it is 
    already installed.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:is_ready}
    \index{shutit\_main \textit{(module)}!shutit\_main.is\_ready \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{is\_ready}(\textit{shutit}, \textit{shutit\_module\_obj})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Returns true if this module is ready to be built. Caches the result (as
    it's assumed not to change during the build).

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:init_shutit_map}
    \index{shutit\_main \textit{(module)}!shutit\_main.init\_shutit\_map \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{init\_shutit\_map}(\textit{shutit})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Initializes the module map of shutit based on the modules we have 
    gathered.

    Checks we have core modules Checks for duplicate module details. Sets 
    up common config. Sets up map of modules.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:config_collection}
    \index{shutit\_main \textit{(module)}!shutit\_main.config\_collection \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{config\_collection}(\textit{shutit})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Collect core config from config files for all seen modules.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:config_collection_for_built}
    \index{shutit\_main \textit{(module)}!shutit\_main.config\_collection\_for\_built \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{config\_collection\_for\_built}(\textit{shutit})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Collect configuration for modules that are being built. When this is 
    called we should know what's being built (ie after dependency 
    resolution).

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:allowed_image}
    \index{shutit\_main \textit{(module)}!shutit\_main.allowed\_image \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{allowed\_image}(\textit{shutit}, \textit{module\_id})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Given a module id and a shutit object, determine whether the image is 
    allowed to be built.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:conn_target}
    \index{shutit\_main \textit{(module)}!shutit\_main.conn\_target \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{conn\_target}(\textit{shutit})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Connect to the target.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:finalize_target}
    \index{shutit\_main \textit{(module)}!shutit\_main.finalize\_target \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{finalize\_target}(\textit{shutit})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Finalize the target using the core finalize method.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:resolve_dependencies}
    \index{shutit\_main \textit{(module)}!shutit\_main.resolve\_dependencies \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{resolve\_dependencies}(\textit{shutit}, \textit{to\_build}, \textit{depender})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Add any required dependencies.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:check_dependee_exists}
    \index{shutit\_main \textit{(module)}!shutit\_main.check\_dependee\_exists \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{check\_dependee\_exists}(\textit{shutit}, \textit{depender}, \textit{dependee}, \textit{dependee\_id})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Checks whether a depended-on module is available.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:check_dependee_build}
    \index{shutit\_main \textit{(module)}!shutit\_main.check\_dependee\_build \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{check\_dependee\_build}(\textit{shutit}, \textit{depender}, \textit{dependee}, \textit{dependee\_id})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Checks whether a depended on module is configured to be built.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:check_dependee_order}
    \index{shutit\_main \textit{(module)}!shutit\_main.check\_dependee\_order \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{check\_dependee\_order}(\textit{\_shutit}, \textit{depender}, \textit{dependee}, \textit{dependee\_id})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Checks whether run orders are in the appropriate order.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:make_dep_graph}
    \index{shutit\_main \textit{(module)}!shutit\_main.make\_dep\_graph \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{make\_dep\_graph}(\textit{depender})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Returns a digraph string fragment based on the passed-in module

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:check_deps}
    \index{shutit\_main \textit{(module)}!shutit\_main.check\_deps \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{check\_deps}(\textit{shutit})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Dependency checking phase is performed in this method.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:check_conflicts}
    \index{shutit\_main \textit{(module)}!shutit\_main.check\_conflicts \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{check\_conflicts}(\textit{shutit})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Checks for any conflicts between modules configured to be built.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:check_ready}
    \index{shutit\_main \textit{(module)}!shutit\_main.check\_ready \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{check\_ready}(\textit{shutit}, \textit{throw\_error}={\tt True})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Check that all modules are ready to be built, calling check\_ready on 
    each of those configured to be built and not already installed (see 
    is\_installed).

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:do_remove}
    \index{shutit\_main \textit{(module)}!shutit\_main.do\_remove \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{do\_remove}(\textit{shutit})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Remove modules by calling remove method on those configured for 
    removal.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:build_module}
    \index{shutit\_main \textit{(module)}!shutit\_main.build\_module \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{build\_module}(\textit{shutit}, \textit{module})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Build passed-in module.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:do_build}
    \index{shutit\_main \textit{(module)}!shutit\_main.do\_build \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{do\_build}(\textit{shutit})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Runs build phase, building any modules that we've determined need 
    building.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:do_test}
    \index{shutit\_main \textit{(module)}!shutit\_main.do\_test \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{do\_test}(\textit{shutit})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Runs test phase, erroring if any return false.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:do_finalize}
    \index{shutit\_main \textit{(module)}!shutit\_main.do\_finalize \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{do\_finalize}(\textit{shutit})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Runs finalize phase; run after all builds are complete and all modules 
    have been stopped.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:shutit_module_init}
    \index{shutit\_main \textit{(module)}!shutit\_main.shutit\_module\_init \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{shutit\_module\_init}(\textit{shutit})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Initialize.

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:setup_shutit_path}
    \index{shutit\_main \textit{(module)}!shutit\_main.setup\_shutit\_path \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{setup\_shutit\_path}()

\setlength{\parskip}{2ex}
\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:shutit_main}
    \index{shutit\_main \textit{(module)}!shutit\_main.shutit\_main \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{shutit\_main}()

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Main ShutIt function.

    Handles the configured actions:

    \begin{itemize}
    \setlength{\parskip}{0.6ex}
      \item skeleton     - create skeleton module

      \item serve        - run as a server

      \item list\_configs - output computed configuration

      \item depgraph     - output digraph of module dependencies

    \end{itemize}

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{shutit_main:do_phone_home}
    \index{shutit\_main \textit{(module)}!shutit\_main.do\_phone\_home \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{do\_phone\_home}(\textit{msg}={\tt None}, \textit{question}={\tt \texttt{'}\texttt{Error seen - would you like to inform the maintainers?}\texttt{'}})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    Report message home. msg - message to send home question - question to 
    ask - assumes Y/y for send message, else no

\setlength{\parskip}{1ex}
    \end{boxedminipage}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               Variables                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \subsection{Variables}

    \vspace{-1cm}
\hspace{\varindent}\begin{longtable}{|p{\varnamewidth}|p{\vardescrwidth}|l}
\cline{1-2}
\cline{1-2} \centering \textbf{Name} & \centering \textbf{Description}& \\
\cline{1-2}
\endhead\cline{1-2}\multicolumn{3}{r}{\small\textit{continued on next page}}\\\endfoot\cline{1-2}
\endlastfoot\raggedright \_\-\_\-p\-a\-c\-k\-a\-g\-e\-\_\-\_\- & \raggedright \textbf{Value:} 
{\tt None}&\\
\cline{1-2}
\end{longtable}

    \index{shutit\_main \textit{(module)}|)}
